---
aliases:
- /convex-function/
author: Yuki Wada
categories:
- 最適化
date: '2025-07-15'
description: 凸関数の性質
draft: false
math: true
slug: convex-function
title: 凸関数の性質
weight: 999
---



<script>
function details_open(bool){
  const elems = document.getElementsByTagName('details');
  const button = document.getElementById('detail-open-button');
  const detailsOpenNext = button.innerText === "証明を開く";
  if (detailsOpenNext){
    button.innerText = "証明を閉じる";
  }
  else {
    button.innerText = "証明を開く";
  }

  for(elem of elems){
    elem.open = detailsOpenNext;
  }
}
</script>

<button type="button" id="detail-open-button" onclick="details_open(true)">証明を開く</button>



## 導入
---

数理最適化の問題を解くとき、「この関数が凸かどうか」は非常に重要な判断基準になります。なぜなら、関数が凸であれば、任意の局所最小解が大域最小解と一致するという性質があるからです。

このような性質により、凸関数は最適化理論の中で特別な位置を占めています。機械学習における損失関数の設計、経済学の効用最大化問題、エンジニアリング分野でのコスト最小化など、さまざまな応用において問題の解析可能性やアルゴリズムの収束保証が凸性に依存しています。

本記事では、まず凸関数の定義を確認し、その幾何的な直感と数学的性質を整理していきます。さらに、連続性や接線による特徴づけといった性質を通して、凸関数がなぜ最適化の世界でこれほどまでに重視されるのかを明らかにしていきます。


<br>


#### この記事で伝えたいこと

本記事では、最適化理論の基礎をなす**凸関数**について、定義・直感的理解・性質の多面的な視点から解説します。単なる定義の確認にとどまらず、

* なぜ凸関数が最適化において重要なのか
* どのようにして凸性が解析やアルゴリズム設計の支えとなるのか
* 凸関数の性質がどのように最適性や大域的最小性に結びつくのか

といった本質的な理解を目指します。

数学的に厳密な議論をベースとしつつ、**図解や幾何的イメージ**を通じて、読者が自らの言葉で「凸性とは何か」を語れるようになることが、本記事の最終的なゴールです。


<br>


#### 記事の対象者

- 凸関数の定義と性質を体系的に学びたい学部生・大学院生
- 機械学習や最適化理論を理論的に深く理解したいエンジニア
- 最適性条件（KKT条件など）に向けた前提知識を強化したい読者
- 数理最適化を厳密に学ぶ中で、「なぜ凸性が重要なのか」を知りたい人


<br>


#### 参考記事

- 凸集合の定義・性質は[この記事]({{< ref "blog/凸集合の性質" >}})も参考にしてください。



<br><br>



## 凸関数の定義
---

「凸関数」という概念は、単に数学的に美しいだけでなく、最適化問題の性質を決定づける核心的な構造を持っています。関数が凸であることは、最適解の存在や一意性、アルゴリズムによる求解の可能性を大きく左右します。

実際、関数が凸であれば、任意の局所最小点が同時に大域最小点であるという強力な性質が得られます。これは、複雑な非線形問題を扱う現代の最適化理論において、計算可能性や収束保証の観点から極めて大きな意味をもちます。

さらに興味深いのは、凸性には幾何的・代数的・解析的な複数の側面があることです。図形的には「グラフ上の2点を結ぶ線分が常にグラフの上側にある」といった視覚的な直感で捉えられ、解析的には「接平面がグラフの下に位置する」ことや「傾きが単調に増加する」ことなどと結びつきます。

このように、凸関数という構造は、単なる定義にとどまらず、解析性・計算性・幾何性が高度に調和した概念です。そのため、最適化の理論と応用のいずれにおいても、避けては通れない中心的な役割を果たします。

それでは次に、こうした豊かな性質を持つ「凸関数」の定義を、厳密に確認していきましょう。


<br>


**Definition (凸関数)**
> 関数 \\(f\: \mathbb{R}^n \to \mathbb{R} \cup \\{ +\infty \\}\\) を \\(\mathbb{R}^n\\) 上の関数とします。
> 任意の \\(x\, y \in \mathbb{R}^n\, 0 \leq \lambda \leq 1\\) に対して以下の不等式が成り立つとき、\\(f\\) を凸関数と定義します。
> \\[ \\begin{gather*}  f(\\lambda x + (1 - \\lambda)y) \\leq \\lambda f(x) + (1 - \\lambda)f(y)  \\end{gather*} \\]
> \\(f\\) が実数値を取る領域を \\(\text{dom} (f) \:= \\{x \\,\\, | \\,\\, f(x) < +\infty\\}\\) と定義します。
> 不等式が成り立つことから、\\(\text{dom} (f)\\) は凸集合になることがわかります。


<br>


#### 補足: 通常の凸関数の定義との整合性
凸集合 \\(C \subset \mathbb{R}^n\\) 上で定義される（\\(+ \infty\\) の値をとらない通常の）凸関数 \\(\tilde{f}\: C \to \mathbb{R}\\) に対して、
上記の定義と適合させるために \\(\mathbb{R}^n\\) 上の関数に拡張するには、

\\[ \\begin{gather*}  f(x) \:= \\begin{cases} \\tilde{f} (x) \\\; (x \\in C) \\\\ + \\infty \\\; (x \\notin C) \\end{cases}  \\end{gather*} \\]

と \\(C\\) 以外の元で \\(+ \infty\\) の値を取るように修正すればよいです。


<br>


#### 補足: 凸関数の加重平均による不等式 <a id="weighted-average"></a>

凸関数の定義から、3 つ以上の元の加重平均の場合に拡張した以下の性質が成り立ちます。

> \\(x _ {1}\, \dots\, x _ {t} \in \text{dom} (f)\\) とし、
> \\(a _ {1}\, \dots\, a _ {t}\\) を \\(a _ {1} + \dots + a _ {t} = 1\\) を満たす非負実数とすると、
> \\[ \\begin{gather*}  f(\\sum _ {i = 1}^{t} a _ {i} x _ {i}) \\leq \\sum _ {i = 1}^{t} a _ {i} f(x _ {i})  \\end{gather*} \\]
> が成り立ちます。
> 
> 証明は数学的帰納法を使えば可能です。


<br>


## 凸関数の性質
---

### 凸関数の連続性

凸関数の定義からは、グラフ上の2点を結ぶ線分が関数値の上側に位置するという幾何的な性質が導かれます。
このイメージから、「凸関数ならば不連続な跳びが起きるようなことはなく、当然連続であってほしい」と直感的には思えます。

実際、凸関数はある点の周囲で関数が定義されていれば、その点で連続になるという性質を持ちます。
しかし、関数の定義域の「端」や「境界」ではこの連続性が保証されないという点は注意する必要があります。連続性が成立するためには、関数の定義域がその点を内点として含む必要があります。
このように、凸関数の連続性が成り立つかどうかは、単なる直感に頼るのではなく、しっかりと条件を確認する必要があります。

次に、こうした前提のもとで成り立つ「凸関数の連続性」について、命題として紹介します。


<br>


**Propositon（凸関数の連続性）**
> \\(f\\) を \\(\mathbb{R}^{n}\\) 上の凸関数とします。\\(x\\) が \\(\text{dom} (f)\\) の内点なら、\\(f\\) は \\(x\\) で連続です。
> 
> <details><summary>(Proof)</summary><div>
> 
> \\(x\\) が \\(\text{dom} (f)\\) の内点なので、\\(n + 1\\) 個の点 \\(x _ {0}\, x _ {1}\, \dots\, x _ {n} \in \text{dom}(f)\\) が存在して、\\(x\\) が \\(\text{conv} (\\{ x _ {i} \\})\\) の内点となるようにとれます。
> よって、ある \\(r > 0\\) が存在して、\\(x\\) を中心とした半径 \\(r\\) の開球 \\(B(x\, r)\\) が \\(\text{conv} (\\{ x _ {i} \\})\\) に含まれるようにできます。
>
> 次に、
>
> \\[ \\begin{gather*}  \\mu \:= \\max (\\\{ f(x _ {i}) \\\}) \\end{gather*} \\]
> 
> とおくと、\\(f\\) が凸関数であるため、\\(w \in \text{conv} (\\{ x _ {i} \\})\\) なら、\\(f(w) \leq \mu\\) となります。
> とくに \\(w \in B(x\, r)\\) であっても \\(f(w) \leq \mu\\) がいえます。
>
> ここから連続性を示します。\\(f\\) を \\(f - f(x)\\) で置き換えることで、\\(f(x) = 0\\) としても一般性を失いません。
> 
> 任意の \\(\varepsilon > 0\\) をとります。
> \\(z \in B(x\, \varepsilon r)\\) ならば \\(|f(z)| < \varepsilon \mu\\) を示せば \\(x\\) における連続性がわかります。
> 
> まず \\(f(z) < \varepsilon \mu\\) を示しましょう。
> \\(z \:= (1 - \varepsilon) x + \varepsilon w\\) を満たすように \\(w\\) をとりましょう。
> このとき、\\( w = x + \frac{1}{\varepsilon} (z - x)\\) なので \\(w \in B(x\, r)\\) となるから、
> \\(f(z) \leq (1 - \varepsilon) f(x) + \varepsilon f(w) \leq \varepsilon \mu\\) がいえます。
> よって、示せました。
> 
> 次に \\(- f(z) < \varepsilon \mu\\) を示しましょう。
> \\(x \:= \frac{1}{1 + \varepsilon} z + \frac{\varepsilon}{1 + \varepsilon} w'\\) を満たすように \\(w'\\) をとる。
> このとき、\\( w' = x - \frac{1}{\varepsilon} (z - x)\\) なので \\(w \in B(x\, r)\\) となるから、
> \\(f(x) \leq \frac{1}{1 + \varepsilon} f(z) + \frac{\varepsilon}{1 + \varepsilon} f(w')\\) がいえます。
> よって、
>
> \\[ \\begin{gather*} -f(z) \\leq \\varepsilon f(w) \\leq \\varepsilon \\mu \\end{gather*} \\]
>
> が示せました。
> 
> 以上より、\\(f\\) が \\(x\\) で連続であることが示せました。
> 
> </div></details>


<br>


### 凸関数と接超平面がグラフの位置関係

凸関数の定義は、関数値に関する不等式という代数的な表現で与えられますが、幾何的な構造にも大きく関わっています。

とくに、凸関数の重要な特徴のひとつは、「グラフの任意の点において、その点で接する接平面が関数のグラフの下側に位置する」という性質です。
言い換えれば、接平面が常に関数を下から支えているという構造です。

この性質は、解析的には関数の接平面が接点において関数値を過小評価するという不等式として表現されます。
この視点を通じて、凸性は微分可能性や勾配・双対性といった他の解析的概念と自然に結びつきます。

さらに重要なのは、こうした接平面による特徴づけは、凸関数の定義と同値であるという点です。
すなわち、「接超平面が常に関数のグラフの下にある」ことと、「関数が凸である」ことは互いに言い換え可能なのです。

以下では、これを命題として厳密に述べ、その証明も確認していきます。


<br>


**Propositon（「凸関数であること」と「接超平面がグラフの下に位置すること」は同値）** <a id="convec-function-hyperplane"></a>
> \\(f\: \mathbb{R}^{n} \rightarrow \mathbb{R} \cup \\{ + \infty\\}\\) とします。
> さらに \\(\text{dom} (f)\\) が開集合であるとします。
> 
> このとき、以下の条件 (a)、(b) は同値です:
> 
> (1) \\(f\\) が凸関数。
> 
> (2) 任意の \\(x \in \text{dom} (f)\\) に対して、ある \\( a _ {x} \in \mathbb{R}^n \\) が存在して
> 「任意の \\(y \in \mathbb{R}^n \\) に対して、\\(f(y) - f(x) \geq \langle a _ {x}\, y - x \rangle\\)」が成り立つ。
> 
> <details><summary>(Proof)</summary><div>
> 
> (1) \\(\Rightarrow\\) (2)  
> 
> \\(C \:= \\{ (x\, w) \in \mathbb{R}^{n} \times \mathbb{R} \\; | \\; w > f(x) \\}\\) を考えます。
> このとき、\\((x\, f(x)) \notin C\\) であり、\\(f\\) が凸関数であることから \\(C\\) は凸集合になります。
> 
> [凸集合の分離定理]({{< ref "blog/凸集合の性質" >}}#separating-hyperplane-theorem)から以下を満たす \\((a _ {1}\, a _ {2}) \neq (0\, 0)\\) が存在します:
> 
> \\[ \\begin{gather*}  \\langle a _ {1}\, y \\rangle + a _ {2} \\cdot w \\geq b \\end{gather*} \\]
> \\[ \\begin{gather*}  \\langle a _ {1}\, x \\rangle + a _ {2} \\cdot f(x) \\leq b \\end{gather*} \\]
> 
> \\(w \rightarrow + \infty\\) とできることから、不等式を満たすためには \\(a _ {2} \geq 0\\) でなければなりません。
> また、\\(a _ {2} = 0\\) と仮定すると、\\(\langle a _ {1}\, y - x \rangle \geq 0\\) となるが、
> \\(x\\) が \\(\text{dom}(f)\\) の内点であることから、\\(y\\) に \\(x\\) の近傍の点を代入できるため、\\(a _ {1} = 0\\) でなければなりません。
> しかし、これは \\((a _ {1}\, a _ {2}) \neq (0\, 0)\\) に矛盾します。よって、\\(a _ {2} > 0\\) が示せました。
> 
> 上式から下式を引いて、両辺を \\(a _ {2}\\) で割れば、
> 
> \\[ \\begin{gather*}  w - f(x) \\geq \\left \\langle - \\frac{a _ {2}}{a _ {1}}\, y - x \\right \\rangle  \\end{gather*} \\]
> 
> となるため、\\(w \rightarrow f(y)\\) として、(2) が成り立つことが示せました。
> 
> (2) \\(\Rightarrow\\) (1)
> 
> \\(x\, y \in \mathbb{R}^{n}\\) と \\( 0 \leq \lambda \leq 1\\) を、
> \\(x _ {0} \:= (1 - \lambda) x + \lambda y\\) を満たすように任意でとります。
> 
> (2) より以下を満たす \\(a _ {z}\\) が存在します:
> 
> \\[ \\begin{gather*}  f(x) - f(x _ {0}) \\geq \\langle a _ {z}\, x - x _ {0} \\rangle\, \\\\   f(y) - f(x _ {0}) \\geq \\langle a _ {x _ {0}}\, y - x _ {0} \\rangle.  \\end{gather*} \\]
> 
> 第一式に \\(1 - \lambda\\) をかけた式を、 第二式に \\(\lambda\\) をかけた式を足すと、
> 
> \\[ \\begin{gather*}  (1 - \\lambda) (f(x) - f(x _ {0})) + \\lambda (f(y) - f(x _ {0}))   \\geq (1 - \\lambda) \\langle a _ {x _ {0}}\, x - x _ {0} \\rangle + \\lambda \\langle a _ {z}\, y - x _ {0} \\rangle \\end{gather*} \\]
> 
> となりますので、式を整理して、
> 
> \\[ \\begin{gather*}  (1 - \\lambda) f(x) + \\lambda f(y) - f(x _ {0})   \\geq \\langle a _ {x _ {0}}\, (1 - \\lambda) x + \\lambda y - x _ {0} \\rangle = 0 \\end{gather*} \\]
> 
> となることから、(1) が示せました。
> 
> </div></details>


<br>


### 一変数凸関数と直線の傾きの関係

「凸関数であること」と「接超平面がグラフの下に位置すること」が同値であることがわかりました。
特に一変数関数に対する接超平面は接線であり、とくに接線の傾きという一次元のパラメータで表現することが可能です。
一般的に、直線の傾きが単調に増加するという直感的な性質と、数学的な凸性とが同値であることが知られています。
この関係を明確にするために、以下の命題を紹介します。


<br>


**Propositon（「一変数凸関数であること」と「傾きの単調増加」は同値）**
> \\(f\: \mathbb{R}^{n} \rightarrow \mathbb{R} \cup \\{ + \infty\\}\\) とし、以下は同値です。
> さらに \\(\text{dom} (f)\\) が開集合であるとします。
>
> 傾きを求める関数 \\(\phi _ {x} (y) \:= \frac{f(y) - f(x)}{y - x} \\; (y \neq x)\\) を定義します。
> このとき、以下の条件 (a)、(b) は同値です:
> 
> (1) \\(f\\) が凸関数。
> 
> (2-a) 任意の \\( x \in \text{dom}(f) \\) に対して、\\(\phi _ {x} (y)\\) が \\(x < y\\) で広義単調増加。
> 
> (2-b) 任意の \\( x \in \text{dom}(f) \\) に対して、\\(\phi _ {x} (y)\\) が \\(y < x\\) で広義単調増加。
> 
> (2-c) 任意の \\( x \in \text{dom}(f) \\) に対して、\\(y _ {1} < x < y _ {2}\\) ならば、\\(\phi _ {x} (y _ {1}) \leq \phi _ {x} (y _ {2})\\) が成り立つ。
> 
> <details><summary>(Proof)</summary><div>
> 
> (1) \\(\Leftrightarrow\\) (2-a)
> 
> \\( x \in \text{dom}(f) \\) を固定し、\\(x < z < y\\) を任意にとります。
> このとき、\\( \phi _ {x} (z) \leq \phi _ {x} (y)\\) が成立することを示しましょう。
> 
> \\(z - x = \lambda (y - x)\\) となる \\(0 < \lambda < 1\\) をとります。
> よって、
> 
> \\[ \\begin{align*}   & f(z) \\leq (1 - \\lambda) f(x) + \\lambda f(y) \\\\   \\Leftrightarrow & f(z) - f(x) \\leq \\lambda (f(y) - f(x)) \\\\   \\Leftrightarrow & \\frac{f(z) - f(x)}{z - x} \\leq \\frac{f(y) - f(x)}{y - x}   \\end{align*}\\]
> 
> となるので示せました。
> 
> (1) \\(\Leftrightarrow\\) (2-b)
> 
> \\( x \in \text{dom}(f) \\) を固定し、\\(x < z < y\\) を任意にとります。
> このとき、\\( \phi _ {y} (x) \leq \phi _ {y} (z)\\) が成立することを示しましょう。
> 
> \\(y - z = \lambda (y - x)\\) となる \\(0 < \lambda < 1\\) をとります。
> よって、
> 
> \\[ \\begin{align*}   & f(z) \\leq (1 - \\lambda) f(y) + \\lambda f(x) \\\\   \\Leftrightarrow & \\lambda (f(y) - f(x)) \\leq f(y) - f(z) \\\\   \\Leftrightarrow & \\frac{f(y) - f(x)}{y - x} \\leq \\frac{f(y) - f(z)}{y - z} \\\\   \\Leftrightarrow & \\frac{f(x) - f(y)}{x - y} \\leq \\frac{f(z) - f(y)}{z - y}    \\end{align*}\\]
> 
> となるので示せました。
> 
> (1) \\(\Leftrightarrow\\) (2-c)
> 
> \\( x \in \text{dom}(f) \\) を固定し、\\(x < z < y\\) を任意にとります。
> このとき、\\( \phi _ {z} (x) \leq \phi _ {z} (y)\\) が成立することを示しましょう。
> 
> \\(z - x = \lambda (y - x)\\) となる \\(0 < \lambda < 1\\) をとります。
> このとき、\\(y - z = (y - x) - (z - x) = (1 - \lambda) (y - x)\\) となります。
> よって、
>
> \\[ \\begin{align*}   & f(z) \\leq (1 - \\lambda) f(x) + \\lambda f(y) \\\\   \\Leftrightarrow & (1 - \\lambda) (f(z) - f(x)) \\leq \\lambda (f(y) - f(z)) \\\\   \\Leftrightarrow & \\frac {(f(z) - f(x))} {\\lambda} \\leq \\frac{f(y) - f(z)} {1 - \\lambda} \\\\   \\Leftrightarrow & \\frac{f(z) - f(x)}{z - x} \\leq \\frac{f(y) - f(z)}{y - z} \\\\   \\Leftrightarrow & \\frac{f(x) - f(z)}{x - z} \\leq \\frac{f(y) - f(z)}{y - z}    \\end{align*}\\]
> 
> となるので示せました。
> 
> </div></details>


<br>


### 極小値と最大値の一致

最適化問題において、ある点が「最適解」であるかを判定するために、勾配がゼロになる（停留点である）という必要条件を用います。ですが一般にはこの条件だけでは不十分であり、停留点が極小点とは限らないというのが非線形最適化の難しさでもあります。

ところが、関数が凸である場合には事情が大きく変わります。

凸関数に対しては、停留点であるという条件が、そのまま大域的最小解であることを保証してくれるのです。
これは理論だけでなく求解の観点からも強力な性質であり、凸最適化問題が「解きやすい」とされる理由のひとつです。

以下では、この事実を命題として形式的に確認します。


<br>


**Propositon（凸関数ならば停留点ならば最適解）** <a id="stationary-point-is-optimal"></a>
> 
> \\(f\\) を \\(C^{1}\\) 級の凸関数とします。
> このとき、\\(f\\) の停留点は大域的最小点になります。
> 
> <details><summary>(Proof)</summary><div>
> 
> [凸関数の性質](#convec-function-hyperplane)から
> 任意の \\(x\, y \in \text{dom}(f)\\) に対して
>
> \\[ \\begin{gather*}  f(y) \\geq f(x) + \\langle \\nabla f(x)\, y - x \\rangle  \\end{gather*} \\]
>
> が成り立ちます。
> 
> ここで \\(x = x^{\ast}\\) を代入すると、任意の \\(y \in \mathbb{R}^n \\) に対して
> 
> \\[ \\begin{gather*}  f(y) \\geq f(x^{\\ast}) + \\langle \\nabla f(x^{\\ast})\, y - x^{\\ast} \\rangle  \\end{gather*} \\]
> 
> が成り立ちます。
> 
> 仮定より \\(\nabla f(x^{\ast}) = 0\\) なので、
> 
> \\[ \\begin{gather*}  \\langle \\nabla f(x^{\\ast})\, y - x^{\\ast} \\rangle = \\langle 0\, y - x^{\\ast} \\rangle = 0  \\end{gather*} \\]
> したがって、
> 
> \\[ \\begin{gather*}  f(y) \\geq f(x^{\\ast})  \\end{gather*} \\]
> 
> が任意の \\(y\\) に対して成り立ちます。つまり、\\(x^{\ast}\\) は \\(f\\) の大域的最小点です。
> 
> </div></details>



<br><br>



## Jensen の不等式

### Jensen の不等式の意義

[凸関数の加重平均による不等式](#weighted-average)で見てきたように、凸関数は「入力値を加重平均」した \\(f(\sum _ {i = 1}^{t} a _ {i} x _ {i})\\) よりも「出力値を加重平均」した値 \\(\sum _ {i = 1}^{t} a _ {i} f(x _ {i})\\) のほうが大きくなるという直感的な性質を持ちます。
これは最適化理論だけでなく、確率論においても重要な意味をもちます。

確率論の文脈では、「入力値」が確率変数であり、「加重平均」が期待値に対応します。このとき、加重平均の場合と同様の問題を考察すると、次のような問いが自然に現れます:

> ある関数 \\(f\\) に対して、\\(f(\mathbb{E}(X))\\) と \\(\mathbb{E}(f(X))\\) はどちらが大きいか？

このような疑問に答えるのが、Jensen の不等式であり、
有限個の元を加重平均したケースを無限個の元に拡張した場合とみなすことが可能です。

Jensen の不等式は、凸関数という解析的性質と、期待値という確率的概念とを橋渡しする根本的なツールです。単なる数学的テクニックにとどまらず、

- 期待値を含む不等式の評価
- リスクの下限評価（例: エントロピー、分散、KL ダイバージェンスなど）
- マルチンゲール理論や確率的収束の解析

といった多くの理論と応用で登場します。

特に機械学習やベイズ推論では、Jensen の不等式を応用した上界・下界評価（例：ELBOなど）が理論の骨格を成しています。よって、「凸性から何が導かれるのか」を理解する上で、Jensen の不等式は最も象徴的な命題のひとつといえるでしょう。

以下では、期待値と凸性の関係を厳密に記述する命題として、Jensen の不等式を紹介します。


<br>


**Propositon（Jensen の不等式）**
> 
> \\(f\\) を凸関数とし、\\(X\\) を確率ベクトルとします。
> さらに、\\(\mathbb{E} (X)\\) が \\(\text{dom} (f)\\) の内部（= \\(\text{dom} (f)\\) の内点の集合）に含まれているとします。
> 
> このとき、
> 
> \\[ \\begin{gather*}  \\mathbb{E} (f(X)) \\geq f ( \\mathbb{E} (X) )  \\end{gather*} \\]
> 
> が成り立つ。
> 
> <details><summary>(Proof)</summary><div>
> 
> \\(\mathbb{E}(X)\\) が \\(\text{dom} (f)\\) の内点であるため、[凸関数の性質](#convec-function-hyperplane)から 以下の不等式が成り立ちます:
> 
> \\[ \\begin{gather*}  f(t) - f(\\mathbb{E} (X)) \\geq \\langle a\, t - \\mathbb{E} (X) \\rangle  \\end{gather*} \\]
>
> \\(f\\) の条件から、\\(f\\) は Borel 可測関数です（証明は煩雑なだけなので省略します）。 
> 
> \\(t = X\\) を代入して、\\(\mathbb{E} ( \cdot )\\) を施すことで、
> 
> \\[ \\begin{align*}   \\mathbb{E} (f(X)) - f( \\mathbb{E} (X) )   \\geq & \\mathbb{E} \\left( \\langle a\, X - \\mathbb{E} (X) \\rangle \\right) \\\\   = & \\langle a\, \\mathbb{E} \\left( X - \\mathbb{E} (X) \\right) \\rangle \\\\   = & \\langle a\, \\mathbb{E} (X) - \\mathbb{E} (X) \\rangle \\\\   = & 0   \\end{align*} \\] 
> 
> となるため、示せました。
> 
> </div></details>


<br>


### 条件付き期待値に対する Jensen の不等式の意義

Jensen の不等式は、関数と期待値の順序の交換における凸性の効果を明確に表す基本的な道具ですが、確率論や確率過程の応用では、より柔軟な形式が必要とされる場面が少なくありません。
特に、情報が逐次的に更新される状況、たとえば時刻 \\(t\\) までの情報に基づいて将来を予測するような場合には、条件付き期待値が本質的な役割を果たします。

このような枠組みは、マルチンゲール理論を含む確率過程論や、その適用先である金融工学においてヘッジ戦略の設計やオプション価格評価など、現代的な応用において重要な位置を占めています。
したがって、Jensen の不等式の条件付き期待値版は、こうした状況でも凸性の性質を活用するための有力な手段となります。

以下にその形式を示します。


<br>


**Propositon（条件付き期待値に対する Jensen の不等式）**
> 
> \\(f\\) を凸関数とし、\\(X\\) を確率ベクトルとします。
> さらに、
> 
> - \\(f\\) が一変数関数
> - \\(\text{dom} (f)\\) の内部において \\(C^{1}\\) 級 
> 
> のいずれかの条件を満たし、\\(\mathbb{E} (X | \mathcal{F})\\) の値がほとんど \\(\text{dom} (f)\\) の内部に含まれているとします。
> 
> このとき、
> 
> \\[ \\begin{gather*}  \\mathbb{E} (f(X) | \\mathcal{F}) \\geq f ( \\mathbb{E} (X | \\mathcal{F}) )  \\end{gather*} \\]
> 
> <details><summary>(Proof)</summary><div>
> 
> \\(\text{dom} (f)\\) の内点である \\(x\\) に対して、[凸関数の性質](#convec-function-hyperplane)から以下の不等式が成り立ちます:
> 
> \\[ \\begin{gather*}  f(t) - f(x) \\geq \\langle a(x)\, t - x \\rangle  \\end{gather*} \\]
>
> \\(f\\) が満たしている条件から、\\(a\\) を Borel 可測関数にとることができます。（証明は省略します。以下の補足を参照ください。）
> 
> \\(\mathbb{E} (X | \mathcal{F})\\) の値がほとんど \\(\text{dom} (f)\\) に含まれているため、
> \\(t = X\, \\; v = \mathbb{E} (X | \mathcal{F})\\) を代入して、\\(\mathbb{E} ( \cdot | \mathcal{F} )\\) を施すことで、
> 
> \\[ \\begin{align*}   \\mathbb{E} (f(X) | \\mathcal{F}) - f( \\mathbb{E} (X | \\mathcal{F}) )   \\geq & \\mathbb{E} \\left( \\langle a( \\mathbb{E} (X | \\mathcal{F}) )\, X - \\mathbb{E} (X | \\mathcal{F}) \\rangle \\right) \\\\   = & \\langle a( \\mathbb{E} (X | \\mathcal{F}) )\, \\mathbb{E} \\left( X - \\mathbb{E} (X | \\mathcal{F}) | \\mathcal{F} \\right) \\rangle \\\\   = & \\langle a( \\mathbb{E} (X | \\mathcal{F}) )\, \\mathbb{E} (X | \\mathcal{F}) - \\mathbb{E} (X | \\mathcal{F}) \\rangle \\\\   = & 0   \\end{align*} \\] 
> 
> となるため、示せました。
> 
> </div></details>


<br>


#### 補足: 凸関数と接超平面の可測性
本記事では、本筋の理解を妨げないように言及しませんでしたが、「Jensen の不等式」の証明において期待値を取るには厳密には以下の条件が必要です。

- \\(f\\) が Borel 可測関数
- \\(a\\) が Borel 可測関数

実は上記の事実を証明することが可能ですが、その証明は長く煩雑です。
また、実際の問題を考察する際、病的な例である可測でない凸関数に適用したいケースがあるとは思えません。
よって、そのようなコーナーケースによって話の流れを阻害するのは逆効果だと考え、当記事では可測性について最小限の言及にとどめました。



<br><br>



## 結論
 

凸関数は、最適化理論全体を支える概念といえます。その定義に内在する不等式は、幾何的な直感、解析的な性質、そして計算可能性という多方面の視点をつなぎ合わせています。

記事を通して見てきたように、凸性がもたらす性質――連続性、接平面による特徴づけ、傾きの単調性、大域最適性の保証――は、すべて最適化の「解きやすさ」と「解の安定性」に直結しています。さらに、Jensen の不等式に見られるように、凸関数は確率論や情報理論とも深く結びつき、多くの応用的場面に顔を出します。

このように、凸関数という概念を深く理解することは、最適化だけでなく、機械学習、経済学、統計学など、さまざまな分野での問題設定と解析を支える共通言語を手に入れることでもあります。

本記事が、皆さんの中で「凸性」というキーワードが、単なる記号や定義から、問題解決のための強力な道具として位置づけられる一助となれば幸いです。



<br><br>



## 参考文献
- <a id="kanamori"></a>金森敬文（2015）『統計的学習理論』共立出版（機械学習プロフェッショナルシリーズ）


