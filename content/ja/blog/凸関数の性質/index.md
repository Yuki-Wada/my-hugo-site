---
aliases:
- /convex-function/
author: Yuki Wada
categories:
- 最適化
date: '2025-07-15'
description: 凸関数の性質
draft: false
math: true
slug: convex-function
title: 凸関数の性質
weight: 999
---



## 導入
----

数理最適化の問題を解くとき、「この関数が凸かどうか」は非常に重要な判断基準になります。なぜなら、関数が凸であれば、任意の局所最小解が大域最小解と一致するという性質があるからです。

このような性質により、凸関数は最適化理論の中で特別な位置を占めています。機械学習における損失関数の設計、経済学の効用最大化問題、エンジニアリング分野でのコスト最小化など、さまざまな応用において問題の解析可能性やアルゴリズムの収束保証が凸性に依存しています。

本記事では、まず凸関数の定義を確認し、その幾何的な直感と数学的性質を整理していきます。さらに、連続性や接線による特徴づけといった性質を通して、凸関数がなぜ最適化の世界でこれほどまでに重視されるのかを明らかにしていきます。

<br>

#### この記事で伝えたいこと

本記事では、最適化理論の基礎をなす**凸関数**について、定義・直感的理解・性質の多面的な視点から解説します。単なる定義の確認にとどまらず、

* なぜ凸関数が最適化において重要なのか
* どのようにして凸性が解析やアルゴリズム設計の支えとなるのか
* 凸関数の性質がどのように最適性や大域的最小性に結びつくのか

といった本質的な理解を目指します。

数学的に厳密な議論をベースとしつつ、**図解や幾何的イメージ**を通じて、読者が自らの言葉で「凸性とは何か」を語れるようになることが、本記事の最終的なゴールです。

<br>

#### 記事の対象者

- 凸関数の定義と性質を体系的に学びたい学部生・大学院生
- 機械学習や最適化理論を理論的に深く理解したいエンジニア
- 最適性条件（KKT条件など）に向けた前提知識を強化したい読者
- 数理最適化を厳密に学ぶ中で、「なぜ凸性が重要なのか」を知りたい人

<br>

#### 参考記事

- 凸集合の定義・性質は[この記事]({{< ref "blog/凸集合の性質" >}})も参考にしてください。



<br><br>



## 凸関数の定義
----

関数のグラフ上の2点を結ぶ線分が必ずグラフの**上に位置する**性質を持つ関数を凸関数といいます。  

**Definition (凸関数)**

> (1) 集合 \\(C \subset \mathbb{R}^n\\) を凸集合とし、関数 \\(f\: C \to \mathbb{R}\\) を \\(C\\) 上の関数とします。
> 任意の \\(x\, y \in C\\)、\\(0 \leq \lambda \leq 1\\) に対して以下の不等式が成り立つとき、\\(f\\) を凸関数と定義します。  
> \\[ \\begin{gather*}  f(\\lambda x + (1 - \\lambda)y) \\leq \\lambda f(x) + (1 - \\lambda)f(y)  \\end{gather*} \\]
> 
> (2) 関数 \\(f\: \mathbb{R}^n \to \mathbb{R} \cup \\{ +\infty \\}\\) を \\(\mathbb{R}^n\\) 上の関数とします。
> 任意の \\(x\, y \in \mathbb{R}^n\, 0 \leq \lambda \leq 1\\) に対して以下の不等式が成り立つとき、\\(f\\) を凸関数と定義します。
> \\[ \\begin{gather*}  f(\\lambda x + (1 - \\lambda)y) \\leq \\lambda f(x) + (1 - \\lambda)f(y)  \\end{gather*} \\]
> \\(f\\) が実数値を取る領域を \\(\text{dom} (f) \:= \\{x \\,\\, | \\,\\, f(x) < +\infty\\}\\) と定義します。不等式が成り立つことから、\\(\text{dom} (f)\\) は凸集合になることがわかります。

<br>

### 凸関数の例

* \\(f(x) = \|x\|^2 = x _ 1^2 + x _ 2^2 + \cdots + x _ n^2\\)：凸（ヘッセ行列は単位行列 × 2）
* \\(f(x) = \log(\sum _ {i=1}^n e^{x _ i})\\)：凸（機械学習でよく登場）
* \\(f(x) = -\log \det X\\)（対象正定値行列 \\(X\\) 上の関数）：凸

<br>

#### 幾何的な意味
* グラフ上の2点を結ぶ線分が、関数のグラフの**上に位置する**という意味です（スカラー値の関数で）。
* 実質的には1変数の場合と全く同じ構造ですが、点 \\(x\, y\\) は \\(\mathbb{R}^n\\) のベクトルになります。

<br>

#### 凸関数の連続性

凸関数の定義からは、グラフ上の2点を結ぶ線分が関数値の上側に位置するという幾何的な性質が導かれます。
このイメージから、「凸関数ならば不連続な跳びが起きるようなことはなく、当然連続であってほしい」と直感的には思えます。

実際、凸関数はある点の周囲で関数が定義されていれば、その点で連続になるという性質を持ちます。
しかし、関数の定義域の「端」や「境界」ではこの連続性が保証されないという点は注意する必要があります。連続性が成立するためには、関数の定義域がその点を内点として含む必要があります。
このように、凸関数の連続性が成り立つかどうかは、単なる直感に頼るのではなく、しっかりと条件を確認する必要があります。

次に、こうした前提のもとで成り立つ「凸関数の連続性」について、命題として紹介します。

<br>

**Propositon（凸関数の連続性）**
> \\(f\\) を凸関数とします。\\(\text{dom} (f)\\) が \\(x\\) の内点を含むなら、\\(f\\) は \\(x\\) で連続です。
> 
> <details><summary>(Proof)</summary><div>
> 
> 証明は[統計的学習理論](#kanamori)の定理 B.7 を参照してください。
> 
> </div></details>

<br>

## 凸関数の性質
凸関数であることは、ある超平面で分離できることと同値です（要イメージ図）。

**Propositon（凸関数と同値な条件）**
> \\(f\\) を凸関数とします。以下は同値です。
> 
> (1) \\(f\\) が凸関数。
> 
> (2) 任意の \\( x \in \text{dom}(f) \\) に対して、ある \\( a _ {x} \in \mathbb{R}^n \\) が存在して次が成り立つ:  
> 任意の \\(y \in \mathbb{R}^n \\) に対して、\\(f(y) - f(x) \geq \langle a _ {x}\, y - x \rangle\\) が成り立つ。
> 
> <details><summary>(Proof)</summary><div>
> 
> (1) => (2)  
> 
> \\(C \:= \\{ (x\, w) \in \mathbb{R}^{n} \times \mathbb{R} \\; | \\; w > f(x) \\}\\) を考えます。
> このとき、\\((x\, f(x)) \notin C\\) であり、\\(f\\) が凸関数であることから \\(C\\) は凸集合になります。
> 
> \\[ \\begin{gather*}  a _ {1}y + a _ {2} w \\geq b \\end{gather*} \\]
> \\[ \\begin{gather*}  a _ {1}x + a _ {2} f(x) \\leq b \\end{gather*} \\]
> \\(a _ {2} \geq 0\\)
> 
> \\[ \\begin{gather*}  a _ {2} w - f(x) \\geq -a _ {1}y - x \\end{gather*} \\]
> 
> 証明は[統計的学習理論](#kanamori)の定理 B.8 を参照してください。
> 
> (2) => (1)  
> \\(x\, y \in \mathbb{R}^{n}\\) と \\( 0 \leq \lambda \leq 1\\) を任意でとります。
> \\(z \:= (1 - \lambda) x + \lambda y\\) とおく。
> 
> (2) より以下を満たす \\(a _ {z}\\) が存在します:
> 
> \\[ \\begin{gather*}  f(x) - f(z) \\geq \\langle a _ {z}\, x - z \\rangle\, \\\\   f(y) - f(z) \\geq \\langle a _ {z}\, y - z \\rangle.  \\end{gather*} \\]
> 
> 第一式に \\(1 - \lambda\\) をかけた式を、 第二式に \\(\lambda\\) をかけた式を足すと、
> 
> \\[ \\begin{gather*}  (1 - \\lambda) (f(x) - f(z)) + \\lambda (f(y) - f(z))   \\geq (1 - \\lambda) \\langle a _ {z}\, x - z \\rangle + \\lambda \\langle a _ {z}\, y - z \\rangle \\end{gather*} \\]
> 
> となりますので、式を整理して、
> 
> \\[ \\begin{gather*}  (1 - \\lambda) f(x) + \\lambda f(y) - f(z)   \\geq \\langle a _ {z}\, (1 - \\lambda) x + \\lambda y - z \\rangle = 0 \\end{gather*} \\]
> 
> となることから、(1) が示せました。
> 
> </div></details>

関数が一変数の場合を考えると、凸関数であることとある点を基点としたときに線分の傾きが増加していくことと同値です（要イメージ図）。

### Propositon (一変数凸関数と同値な条件)
> \\(f\\) を凸関数とします。以下は同値です。
> 
> (1) \\(f\\) が凸関数。  
> 
> (2) 任意の \\( x \in \text{dom}(f) \\) に対して、\\( \phi _ {x} (y) \:= \frac{f(y) - f(x)}{y - x} \\,\\, (y \neq x)\\) が広義単調増加。
> 
> <details><summary>(Proof)</summary><div>
> 
> はじめに (1) \\(\Rightarrow\\) (2) を示します。  
> \\( x \in \text{dom}(f) \\) を固定し、\\(y _ {1} < x < y _ {2}\\) を任意にとります。
> このとき、\\( \phi _ {x} (y _ {1}) \leq \phi _ {x} (y _ {2})\\) が成立することを示しましょう。
> 
> 最後に (3) \\(\Rightarrow\\) (1) を示します。  
> \\(x\, y \in \text{dom} (f)\\) かつ \\(x < y\\) となる \\(x\, y\\) を考えます。さらに、\\(0 \leq \lambda \leq 1\\) をとり、\\(z \:= (1 - \lambda) x + \lambda y\\) とおきます。このとき \\(x < y < z\\) となるため、
> \\(\phi _ {x}(z) < \phi _ {x}(y)\\)
> \\[ \\begin{gather*}  \\frac{f(z) - f(x)}{z - x} \\leq \\frac{f(y) - f(x)}{y - x}  \\end{gather*} \\]
> \\(z - x = \lambda (y - x)\\) であることに注意すれば、上記の不等式は \\( f(z) - f(x) \leq \lambda (f(y) - f(x)) \\) と同値であり、
> \\[ \\begin{gather*}  f(z) \\leq (1 - \\lambda) f(x) + \\lambda f(y)  \\end{gather*} \\]
> が成り立つことがわかります。よって示せました。
> </div></details>

### Propositon (凸関数ならば停留点ならば最適解)
> <details><summary>(Proof)</summary><div>
> 
> 証明は文献を参照。
> 
> </div></details>



<br><br>



## 結論

凸関数は、関数の形状的・解析的な性質に基づいて最適化問題の解の存在や一意性を保証する強力な道具です。定義から導かれる連続性や接平面による特徴づけ、そして一変数関数における傾きの単調性といった複数の同値な条件は、より高次元かつ複雑な最適化問題にも適用可能な深い構造を示しています。

本記事の内容を通じて、凸関数が数理最適化の基礎を支える「中核概念」であることが理解できるはずです。




<br><br>



## 参考文献
- <a id="kanamori"></a>金森敬文（2015）『統計的学習理論』共立出版（機械学習プロフェッショナルシリーズ）


