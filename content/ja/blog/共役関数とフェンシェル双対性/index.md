---
aliases: []
author: Yuki Wada
categories:
- 最適化
date: '2025-07-13'
description: 共役関数とフェンシェル双対性
draft: true
math: true
slug: convex-conjugation
title: 共役関数とフェンシェル双対性
weight: 999
---



## 導入

制約付き最適化問題を考えるとき、目的関数を最小化するだけでなく、「与えられた制約条件を満たしながら」解を求める必要があります。
このとき、「主問題」と並行して考えられる**双対問題**の存在が、最適化理論の深い構造を形づくっています。

特に**凸最適化問題**においては、「主問題と双対問題の最適値が一致する」こと（**強双対性**）が成り立つかどうかが、理論的にも計算的にも極めて重要です。
この強双対性が成り立つための鍵となるのが、\*\*スレーター条件（Slater's condition）\*\*と呼ばれる実行可能性の仮定です。

本記事では、凸最適化問題の定式化を踏まえたうえで、

* なぜ双対問題を考えるのか
* なぜ強双対性が重要なのか
* スレーター条件がなぜ必要なのか
  といった問いに答えることを目指します。
  最適化の構造的理解に欠かせない「双対性の意味と限界」を、直観と定理の両面から読み解いていきます。

#### この記事で伝えたいこと
本記事では、不等式制約付き最適化問題の基本的な構造を定式化したうえで、ラグランジュ緩和関数や KKT 条件（Karush-Kuhn-Tucker 条件）といった重要概念について紹介します。特に、最適化問題における実行可能性・凸性・滑らかさといった性質が、どのように解の存在や性質に関係しているのかを明確にします。

また、KKT 条件がどのような前提のもとで最適解の特徴づけに使われるか、その背後にある直観や理論的意義を読み解いていきます。最適化における双対性や制約付き問題の取扱いに関心のある読者に向け、数式だけでなく構造的な視点から理解を深めることを目指します。

#### 記事の対象者

- **凸最適化における双対性の本質を理解したい方**
  　→ ラグランジュ双対、強双対性、スレーター条件といった理論的基盤を明確に把握したい方。
-  **単なる KKT 条件の丸暗記にとどまらず、適用の前提を押さえておきたい方**
  　→ KKT 条件がなぜ成り立つのか、スレーター条件との関係を明確にしたい方。
- **最適化理論の応用にあたって、主問題と双対問題の関係を正しく理解したい方**
  　→ 統計的学習理論、経済学、制御理論などで、凸最適化を理論的に扱いたい方。
- **凸解析・最適化理論を体系的に学び直したい方**
  　→ 実行可能性・凸性・双対性といった核心的な概念を整理したい方。



<br><br>



## 共役関数



<br><br>



## フェンシェル双対性

**Propositon (KKT 条件が成り立つならば主・双対問題に最適解が存在する)**
> 凸関数 \\(f\: \mathbb{R}^{N} \rightarrow \mathbb{R} \cup \\{ + \infty \\}\, g\: \mathbb{R}^{M} \rightarrow \mathbb{R} \cup \\{ + \infty \\}\\) とし、
> \\(A\\) を \\(M \times N\\) 型の行列とする。
> 
> このとき、\\(\text{dom} (f) \cap \text{dom} (g)\\) が内点を持つならば、以下の等式が成り立ちます:
> 
> \\[ \\begin{gather*}  \\inf _ {x \\in \\mathbb{R}^{N}} \\left( f (x) + g(A x) \\right) = \\inf _ {\\lambda \\in \\mathbb{R}^{M}} \\left( - f^{\\ast}(-A^{T} \\lambda) -  g^{\\ast} (\\lambda) \\right) \\end{gather*} \\] 
> 
> <details><summary>(Proof)</summary><div>
> 
> 以下の最適化問題 \\(\mathcal{P}\\) を考える:
> \\[ \\begin{gather*}   \\text{Supremum} \\quad & \\phi(x\, y) \:= f(x) + g(y)\, \\\\   \\text{subject to} \\quad   & \\xi(x\, y) \:= y - Ax = 0.   \\end{gather*} \\]
> 最適化問題 \\(\mathcal{P}\\) のラグランジュ緩和関数 \\(L(x\, y)\\) は
> \\[ \\begin{align*}   L(x\, y)   & \:=f(x) + g(y) + \\langle \\lambda\, y - Ax \\rangle \\\\   & = - \\left(\\langle A^{T} \\lambda\, x \\rangle - f(x) \\right) - \\left(\\langle \\lambda\, y \\rangle - g(y) \\right) \\\\   \\end{align*} \\]
> と変形できるから、双対問題の目的関数 \\(\psi(\lambda)\\) は
> \\[ \\begin{align*}   \\psi(\\lambda)   & = \\inf _ {x\, y} L(x\, y) \\\\   & = - \\sup _ {x\, y} \\left(\\langle A^{T} \\lambda\, x \\rangle - f(x)) -    \\langle \\lambda\, y \\rangle - g(y) \\right) \\\\   & = - \\sup _ {x} \\left(\\langle A^{T} \\lambda\, x \\rangle - f(x) \\right) -    \\sup _ {y} \\left(\\langle \\lambda\, y \\rangle - g(y) \\right) \\\\   & = - f^{\\ast} (A^{T} \\lambda) - g^{\\ast} (\\lambda) \\\\   \\end{align*} \\]
> とかける。
> 
> \\(\text{dom} (f) \cap \text{dom} (g)\\) が内点を持つことから、
> 最適化問題 \\(\mathcal{P}\\) が緩和されたスレーター条件が成リ立つことがわかる。よって、以下の強双対定理
> \\[ \\begin{gather*}   \\inf _ {x\, y\, y - Ax = 0} \\phi(x\, y) = \\sup _ {\\lambda} \\psi(\\lambda)   \\end{gather*} \\]
> が成り立つので、
> 
> \\[ \\begin{gather*}  \\inf _ {x \\in \\mathbb{R}^{N}} \\left( f (x) + g(A x) \\right) = \\inf _ {y \\in \\mathbb{R}^{M}} \\left( - f^{\\ast}(-A^{T} y) -  g^{\\ast} (y) \\right) \\end{gather*} \\] 
> 
> が成り立つことが示せた。
> 
> </div></details>



<br><br>



## 結論（修正案）

本記事では、凸最適化問題の基本的な構成を確認し、ラグランジュ関数と双対問題の関係性を明らかにしました。
そのうえで、**強双対性が成立する条件**としてのスレーター条件の役割を強調し、最適解の構造や解釈にどのような影響を与えるのかを考察しました。

双対性は最適化の理論的洗練にとどまらず、\*\*アルゴリズム設計（例：内点法、ラグランジュ緩和法）\*\*や、**問題の数値的安定性の分析**にも密接に関わっています。
また、KKT 条件が強双対性のもとで「最適性の必要十分条件」となることも、理論と計算の橋渡しとして重要です。

今後、より一般的な双対理論や数値的最適化手法に進む際に、本記事で示した構造的理解が強固な基盤となるはずです。
「なぜ双対問題を考えるのか」「なぜ制約の仮定が重要なのか」といった問いに向き合う上で、本稿が一助となれば幸いです。



<br><br>



## 参考文献

- <a id="kanamaori"></a>金森敬文（2015）『統計的学習理論』共立出版（機械学習プロフェッショナルシリーズ）
- <a id="boyd"></a>Boyd, S., & Vandenberghe, L. (2004). *Convex optimization*. Cambridge University Press.


