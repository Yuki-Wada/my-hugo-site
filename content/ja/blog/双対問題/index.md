---
aliases: []
author: Yuki Wada
categories:
- 最適化
date: '2025-07-18'
description: 双対問題
draft: false
math: true
slug: dual-problem
title: 双対問題
weight: 999
---



<script>
function details_open(bool){
  const elems = document.getElementsByTagName('details');
  const button = document.getElementById('detail-open-button');
  const detailsOpenNext = button.innerText === "証明を開く";
  if (detailsOpenNext){
    button.innerText = "証明を閉じる";
  }
  else {
    button.innerText = "証明を開く";
  }

  for(elem of elems){
    elem.open = detailsOpenNext;
  }
}
</script>

<button type="button" id="detail-open-button" onclick="details_open(true)">証明を開く</button>



## 概要
----

最適化問題を扱っていると、「主問題に対して双対問題を立てる」、「双対ギャップを評価する」、「KKT条件を使って解の最適性を確認する」といった内容がよく出てきます。
その一方で、双対問題の定義の背景や、強双対性が成り立つための条件がどこまで一般的なのかをあらためて整理して理解しようとすると、見落としている点が意外と多いことに気づきます。

特に、双対性に関する話題では「弱双対性は常に成り立つが、強双対性は条件付きである」ということが肝になります。さらに、実際の問題で強双対性が成り立つかどうかは、スレーター条件やその緩和条件など、実行可能領域の性質に大きく依存します。

そこで本記事では、双対問題の定義からはじまり、弱双対性・強双対性とその成立条件まで、理論と実践の両面を意識しながら一通りの流れを整理していきます。
双対理論の要点を確認するための、手元に置いておきたい「チートシート」として読んでいただければと思います。

<br>

#### この記事で伝えたいこと

最適化問題における「双対性」は理論的にも応用的にも重要な概念ですが、双対問題の定義、弱双対性・強双対性、そしてそれらが成立する条件（スレーター条件など）を一貫して整理した資料は意外と少なく、学習のたびに混乱しがちです。

本記事では、双対問題の定式化の背景や意味、理論的性質、そして強双対性を保証する条件について丁寧に整理し、一つの流れで全体像を捉えることを目的としています。
特に、凸最適化問題に遭遇したときにどのように双対問題を定式化し、どの条件を確認すればよいかを判断するための、実践的な「チートシート」として活用できる内容を目指しています。

<br>

#### この記事の対象者

- 双対問題の定義や導出方法を体系的に理解したい方
- 弱双対性と強双対性の違いやその意味を整理したい方
- スレーター条件やその緩和形など、強双対性の成立条件を正確に把握したい方
- 凸最適化問題における主問題・双対問題の関係性を理論的に押さえておきたい方
- 数理最適化や機械学習などの実装・研究において、双対性を実践的に利用したい方

<br>

#### 参考記事
- 凸関数の定義・性質は[この記事]({{< ref "blog/凸関数の性質" >}})も参考にしてください。
- 不等式制約付き最適化問題については[この記事]({{< ref "blog/不等式制約付き最適化問題" >}})も参考にしてください。



<br><br>



## 双対問題
----

### なぜ「双対問題」を考えるのか

制約付き最適化問題において、制約を満たしつつ目的関数を最小化する解を直接求めるのは、解析的にも計算的にも困難なことがあります。
そこで登場するのが**ラグランジュ関数**による「緩和」の考え方です。

制約条件をそのまま扱うのではなく、目的関数に制約を重み付きで加算したラグランジュ関数を構成することで、制約付き問題を制約なしの問題に変換することができます。

<br>

**Definition（ラグランジュ緩和関数）**
> 不等式制約付き最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) に対して、
> ラグランジュ緩和関数を以下のように定義します:
> \\[ \\begin{gather*}  L(x\, \\lambda\, \\nu) = f(x) + \\sum _ {i=1}^{m} \\lambda _ i g _ i(x) + \\sum _ {j=1}^{p} \\nu _ j h _ j(x)  \\end{gather*} \\]

<br>

このとき、「ある制約に対する重み（ラグランジュ乗数）を与えたときに、目的関数の最小値がどれくらい小さくなるか？」という問いが自然に現れます。これが**双対関数**であり、その最大化問題として定式化されるのが**双対問題**です。

双対問題は以下のような点で重要な役割を果たします：

- 主問題の解析や計算をより容易にする手段になる（凸性）
* 元の問題（主問題）の下界を与える（弱双対性）
* 適切な条件下では主問題と最適値が一致する（強双対性）

このような背景のもと、本節では双対関数・双対問題の定義を正式に与え、主問題との関係性について明確にしていきます。

<br>

**Definition（双対問題）**
> (1) 不等式制約付き最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) を考えます。
> ラグランジュ緩和関数 \\(L(x\, \lambda\, \nu)\\) に対して、
> \\[ \\begin{gather*}  g(\\lambda\, \\nu) \:= \\inf _ {x \\in \\text{dom} (\\mathcal{P})} L(x\, \\lambda\, \\nu)  \\end{gather*} \\]
> とおきます。
> このとき、以下の最適化問題を元の問題の双対問題と定義します: 
> \\[ \\begin{align*}   \\text{supremum} \\quad & g(\\lambda\, \\nu) \\\\   \\text{subject to} \\quad   & \\lambda \\succeq 0   \\end{align*} \\]
> また、元の問題を主問題といいます。  
> (2) 主問題の最適値を \\(p^{\ast}\\)、双対問題の最適値は \\(d^{\ast}\\) と表記します。また、双対ギャップを \\(p^{\ast} - d^{\ast}\\) と定義します。

<br>

### 双対問題の凸性

双対問題が重要視される理由の一つは、それが常に凸最適化問題になる点にあります。
たとえ主問題が凸でなかったとしても、双対問題は凸性を持つため、適用できるアルゴリズムが豊富であり、また理論的な収束保証もよく研究されています。

双対問題の凸性を示す命題を以下に述べます。

<br>

**Propositon（双対問題の凸性）**
> \\(g(\lambda\, \nu)\\) は凹関数（つまり \\(-g\\) は凸関数）です。
> 　　　　
> <details><summary>(Proof)</summary><div>
> 
> \\(\lambda^{1}\, \\; \lambda^{2}\, \\; \nu^{1}\, \\; \nu^{2}\\) と \\(0 \leq s \leq 1\\) を任意にとり、
> \\(\lambda \:= (1 - s) \lambda^{1} + \lambda^{2}\, \\; \nu \:= (1 - s) \nu^{1} + s \nu^{2}\\) とおきます。
> 
> \\[ \\begin{align*}   L(x\, \\tilde{\\lambda}\, \\tilde{\\nu})   & = f(x) + \\sum _ {i=1}^{m} \\tilde{\\lambda} _ i g _ i(x) + \\sum _ {j=1}^{p} \\tilde{\\nu} _ j h _ j(x) \\\\   & = f(x) + (1 - s) \\sum _ {i=1}^{m} \\lambda^{1} _ {i} g _ i(x) +   s \\sum _ {i=1}^{m} \\lambda^{2} _ {i} g _ i(x) +   (1 - s) \\sum _ {j=1}^{p} \\nu^{1} _ j h _ j(x) +   s \\sum _ {j=1}^{p} \\nu^{2} _ j h _ j(x) \\\\    & \\geq (1 - s) L(x\, \\lambda^{1}\, \\nu^{1}) + s L(x\, \\lambda^{2}\, \\nu^{2}) \\\\   & \\geq (1 - s) g(\\lambda _ {1}\, \\nu _ {1}) + s g(\\lambda _ {2}\, \\nu _ {2}) \\\\   \\end{align*} \\]
> 
> であるため、\\(\inf _ {x}\\) を施すことで、
> 
> \\[ \\begin{gather*}  g(\\lambda\, \\nu) \\geq (1 - s) g(\\lambda _ {1}\, \\nu _ {1}) + s g(\\lambda _ {2}\, \\nu _ {2})  \\end{gather*} \\]
> 
> が成り立ちます。よって、\\(g\\) は凹関数であることが示せました。
> 
> </div></details>



<br><br>



## 弱双対定理と強双対定理
---

双対関数

\\[ \\begin{gather*}  g(\\lambda\, \\mu) = \\inf _ x L(x\, \\lambda\, \\mu)  \\end{gather*} \\]

は、主問題の実行可能解の集合 \\(F\\) の元 \\(x\\) に対して、主問題の目的関数の下界を与える性質があります。
つまり、任意の \\(x \in F\\) と \\( \lambda \geq 0\, \mu\\) に対して
\\[ \\begin{gather*}  g(\\lambda\, \\mu) \\leq f(x)  \\end{gather*} \\]
が成り立ちます。これは、主問題の最適値を下から近似・評価できることを示しており、双対問題を考える意義の一つになります。

このことを命題の形で以下に述べましょう。

<br>

**Propositon (弱双対定理)**
> 不等式制約付き最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) を考えます。
> このとき、以下の不等式が成り立ちます:
> \\[ \\begin{gather*}  p^{\\ast} \\geq d^{\\ast}  \\end{gather*} \\]
> 
> <details><summary>(Proof)</summary><div>
> 
> 実行可能解の集合を \\(F\\) とします。このとき、
> \\[ \\begin{align}   p^{\\ast} & = \\inf _ {x \\in F} f(x) \\nonumber \\\\   & \\geq \\inf _ {x} \\sup _ {\\mu\, \\lambda} L(x\, \\lambda\, \\mu) \\nonumber \\\\   & \\geq \\sup _ {\\mu\, \\lambda} \\inf _ {x} L(x\, \\lambda\, \\mu) \\nonumber \\\\   & \\geq \\sup _ {\\mu\, \\lambda} g(\\mu\, \\lambda) \\nonumber \\\\   & = d^{\\ast} \\nonumber   \\end{align} \\]
> となるので、示せました。
> 
> </div></details>

<br>

弱双対定理によって、双対問題から得られる最適値 \\(d^\ast\\) は常に主問題の最適値 \\(p^\ast\\) 以下、すなわち \\(p^\ast \geq d^\ast\\) が成り立つことが保証されます。これは、どんな制約条件や関数構造であっても常に成立する一般的な性質です。

一方で、双対問題を通じて主問題の最適値 \\(p^\ast\\) を正確に得るには、双対ギャップ \\(p^\ast - d^\ast\\) がゼロになる必要があります。これは強双対性と呼ばれますが、弱双対性とは異なり、一般には成り立ちません。

強双対性が成立するためには、主問題の凸性や制約の緩さに関する特定の条件が満たされている必要があります。代表的な十分条件として知られているのが、次節で説明するスレーター条件です。このような条件が成立するとき、双対問題を解くことが理論的にも計算的にも非常に有効な手段となります。
ここでは、強双対性の主張を簡単にまとめておきます。

<br>

**Statement (強双対性)**
> 不等式制約付き最適化問題 \\(\left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) を考えます。
> 以下の等式が成り立つとき、この最適化問題は強双対性が成り立つといいます。
> \\[ \\begin{gather*}  p^{\\ast} = d^{\\ast}  \\end{gather*} \\]



<br><br>



## 強双対定理の成立条件
---

### スレーター条件

強双対性が成り立つとき、双対問題の最適値から主問題の最適値を正確に読み取ることができ、理論的にも計算的にも非常に大きなメリットがあります。
しかし、前述のとおり、強双対性は一般には自動的に成り立つものではなく、その成立には主問題に対する関するある種の「良い条件」が必要です。

特に、問題が凸最適化問題である場合には、強双対性が成り立つことを保証する十分条件としてよく知られているのが「スレーター条件（Slater's condition）」です。

<br>

**Definition (スレーター条件)**
> 不等式制約付き最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) を考えます。
> さらに \\(\mathcal{P}\\) が凸最適化問題であるとします。
> 
> 以下の条件を満たす \\(x _ {0}\\) が存在するとき、この最適化問題はスレーター条件を満たすと定義します。
> - \\(x _ {0}\\) が \\( \text{dom} (\mathcal{P})\\) の内点である
> - \\(h _ {j}\\) がアフィン関数である
> - \\( g _ i(x _ 0) < 0 \quad (\forall \\, i) \\)
> - \\( h _ j(x _ 0) = 0 \quad (\forall \\, j) \\)

<br>

スレーター条件は、不等式制約に対して厳密な不等号が成立する実行可能解が内点として存在することを要求するものであり、凸最適化における強双対性のキーとなる条件です。
スレーター条件が満たされる場合には、強双対性が必ず成立することが知られています。すなわち、主問題と双対問題の最適値が一致し、双対ギャップがゼロになります。

もう一つの重要な事実は、スレーター条件が満たされるならば双対問題に最適解が存在する、ということです。つまり、双対問題の最適値を実現する解が存在します。
主問題には最適解が存在することは一般的に保証できないので、数値的に最適解を探索することで最適化問題を解くアルゴリズムに対しては、
双対問題の方が主問題よりも解きやすい問題であることがいえます。

以下に、この事実を命題としてまとめておきます。
この命題を証明する重要な道具は凸集合の分離定理です。

<br>

**Propositon（スレーター条件が満たされるならば強双対性が成り立つ）** <a id="slater-condition-proposition"></a>
> 不等式制約付きの**凸最適化問題** \\(\mathcal{P} \left( f\, \\{g _ {i}\\}\, \\{h _ {j}\\} \right)\\) がスレーター条件を満たすならば、強双対性が成り立ちます。
> また、双対問題の最適解も存在します。
> 
> <details><summary>(Proof)</summary><div>
> 
> [Convex optimization](#boyd)の 5.2.3 の手法に沿って証明を進めます。
> 
> まず、\\(h _ {j}\\) がアフィンなので、\\(\\{ h _ {j} \\}\\) の等式制約条件は、ある行列 \\(A\\) と \\(b\\) が存在して、
> 
> \\[ \\begin{gather*} Ax - b = 0 \\end{gather*} \\]
> 
> と書くことができます。
> 実行可能解 \\(\tilde{x}\\) が存在することから、\\(A\\) から一次従属になる行を取り除いても制約条件としては変わらないため、
> \\(A\\) の代わりに \\(A\\) から一次従属になる行を取り除いた行列を代わりに用いることができます。
> よって、行列 \\(A\\) の階数は行数と一致するとしても構いません。
> 
> 次の集合を考えます。
> 
> \\[ \\begin{gather*}  \\mathcal{A} = \\\{ (u\, v\, t) \\\; | \\\;   \\exist x \\in \\text{dom} (\\mathcal{P})\, \\quad   \\quad g _ {i}(x) ≤ u _ {i} \\\; ( \\forall i)\, \\quad   h _ {j}(x) = v _ {j} \\\; (\\forall j)\, \\quad   f(x) \\leq t   \\\}\, \\\\   \\mathcal{B} = \\\{ (0\, 0\, s) ∈ \\mathbb{R}^{m} \\times \\mathbb{R}^{p} \\times \\mathbb{R} \\\; | \\\; s < p^{\\ast} \\\}.  \\end{gather*} \\]
> 
> まず、\\(\mathcal{P}\\) が凸最適化問題であるため \\(\mathcal{A}\\) は凸集合です。
> 次に \\(p^{\ast}\\) は \\(\mathcal{P}\\) の最適値であるため、\\(\mathcal{A} \cap \mathcal{B} = \empty\\) であることがわかります。
> よって、[凸集合の分離定理]({{< ref "blog/凸集合の性質" >}}#separating-hyperplane-theorem)から、
> 以下の条件を満たす \\(\lambda\, \nu\, \mu \in \mathbb{R}^{n}\\) が存在します:
> 
> \\[ \\begin{gather*}  \\langle \\lambda\, u \\rangle + \\langle \\nu\, v \\rangle + \\mu \\cdot t \\geq \\alpha \\\;    \\left( (u\, v\, t)\\in \\mathcal{A} \\right)\, \\\\   \\langle \\lambda\, u \\rangle + \\langle \\nu\, v \\rangle + \\mu \\cdot t \\leq \\alpha \\\;   \\left( (u\, v\, t)\\in \\mathcal{B} \\right).  \\end{gather*} \\]  
> 
> \\((u\, v\, t)\in \mathcal{B}\\) なら \\(u=0\, \\; v=0\\) なので \\(\mu \cdot t \leq \alpha\\) となるので、
> \\( \langle \lambda\, u \rangle + \langle \nu\, v \rangle \geq 0 \\; \left( (u\, v\, t)\in \mathcal{A} \right) \\)
> がいえる。\\(\lambda < 0\\) と仮定すると、
> \\(u \rightarrow + \infty\\)
> とできるため、不等式を満たさない \\(\mathcal{A}\\) の元が存在してしまう矛盾する。よって、\\(\lambda \geq 0\\) がいえる。
> 
> \\(\mu > 0\\) を示しましょう。一旦 \\(\mu = 0\\) が正しいと仮定します。
> \\[ \\begin{gather*}  \\sum _ {i} \\lambda _ {i} g _ {i}(x) + \\langle ν\, Ax − b \\rangle \\geq 0.  \\end{gather*} \\]
> \\(A \tilde{x} − b = 0\\) なので、\\( \sum _ {i} \lambda _ {i} g _ {i}(\tilde{x}) \geq 0\\) とならなければなりません。
> 一方で、\\(g _ {i}(\tilde{x}) < 0\\) となることから \\(\lambda _ {i} \geq 0\\) と合わせて、\\(\lambda _ {i} g _ {i}(\tilde{x}) \leq 0\\) も成り立つ必要があります。
> よって、各不等号は等号で成立する必要があり、\\(g _ {i}(\tilde{x}) \neq 0\\) と合わせて \\(\lambda _ {i} = 0\\) が示せます。
> 
> \\(\lambda _ {i} = 0\\) から \\(\langle ν\, A x − b \rangle \geq 0\\) とならなければなりません。
> 一方で \\(\langle ν\, A \tilde{x} − b \rangle = 0\\) であるから、\\(\langle ν\, A (x - \tilde{x}) \rangle = \langle A^{T} ν\, (x - \tilde{x}) \rangle \geq 0\\) が成り立つ必要があります。
> だが、
> 
> - \\(\tilde{x}\\) が \\(\text{dom} (f)\\) の内点であること
> - 行列 \\(A^{T}\\) の階数が列数と一致するため \\(A^{T}\\) が単射であること
> 
> から、この不等式は成立しえず矛盾が生じます。よって、\\(\mu > 0\\) となることがいえました。
> 
> \\(\mu > 0\\) なので、\\((u\, v\, t)\in \mathcal{B}\\) であることから \\(u = v = 0\, \\; t \rightarrow p^{\ast}\\) と合わせて、
> \\(\alpha \geq \mu p^{\ast}\\) がいえます。
> 
> 次に、\\(\mu > 0\\) なので、任意の \\(x \in \mathcal{P}\\) に対して \\((u\, v\, t)\in \mathcal{A}\\) であることから \\(u \rightarrow g(x)\, \\; v \rightarrow h(x)\, \\; t \rightarrow f(x)\\) と合わせて、
> 
> \\[ \\begin{align*}   L \\left(x\, \\frac{\\lambda} {\\mu}\, \\frac{\\nu} {\\mu} \\right)   = & \\left \\langle \\frac{\\lambda} {\\mu}\, g(x) \\right \\rangle + \\left \\langle \\frac{\\nu} {\\mu}\, h(x) \\right \\rangle + f(x)   \\geq \\frac{\\alpha} {\\mu}   = p^{\\ast}.   \\end{align*} \\]
> 
> がいえるので、左辺に \\(\inf _ {x \in \text{dom} (\mathcal{P}) }\\) を施して、
> \\(g \left(\frac{\lambda} {\mu}\, \frac{\nu} {\mu} \right) \geq p^{\ast}\\) が示せました。
> よって、弱双対定理と合わせて、\\(p^{\ast} = d^{\ast}\\) がわかります。
> 
> また、\\(g \left(\frac{\lambda} {\mu}\, \frac{\nu} {\mu} \right) = p^{\ast}\\) がいえるので、\\(\left( \frac{\lambda} {\mu}\, \frac{\nu} {\mu} \right)\\) が双対問題の最適解になることもいえました。
> 
> (2) 行列 \\(A\\) の階数が行数と一致しないケースを考えます。  
> 実行可能解 \\(\tilde{x}\\) が存在することから、一次従属になる行を取り除いても制約条件としては変わらないことがわかります。
> よって、一次従属になる行を取り除いた行列 \\(A\\) を代わりに用いることで (1) に帰着可能です。
> 
> 以上より、示すことができました。
> 
> </div></details>

<br>

#### 補足：相対的内点について

スレーター条件を定義する際、厳密な不等式が成立する点 \\(x _ {0}\\) が定義域 \\(\text{dom} (\mathcal{P})\\) の内点であることをこの記事では要求しています。
ただし、\\(\text{dom} (\mathcal{P})\\) が低次元の部分集合（例えばある超平面上）に含まれている場合など、通常の意味での内点がそもそも存在しないことがあります。このような場合に対して、\\(\text{dom} (\mathcal{P})\\) を含む最小のアフィン部分空間における内点、すなわち「相対的内点（relative interior）」という概念が必要になります。一般的なテキストでは、\\(x _ {0}\\) を \\(\text{dom} (\mathcal{P})\\) の「内点」ではなく、「相対的内点」であると定義することがほとんどでしょう。

本記事では、本筋の理解を妨げないように相対的内点という定義を持ち出してはいません。その理由は以下の通りです:
- 相対的内点の定義は直感的に理解しにくく、またその必要性が見えづらいケースも多いため
- たとえ \\(\text{dom} \mathcal{P}\\) があるアフィン部分空間に含まれていたとしても、問題をその空間に制限することで、通常の内点を持つ設定に帰着でき、議論に影響を及ぼさないため。

したがって、この記事で述べたスレーター条件における「内点」という表現は、「相対的内点」と読み替えても問題なく通用することを留意しておいてください。


<br>


### 緩和されたスレーター条件

先ほど紹介したスレーター条件は、強双対性を保証する十分条件として非常に有用ですが、実用上はやや強すぎる仮定となることもままあります。
特に注意すべきなのは、全ての不等式制約に対して「厳密な不等号（\\(<\\)）」が成立する必要がある点です。多くの最適化問題ではこの条件でも十分であるケースが多いですが、線形計画法のような重要な応用問題に対して満たされないケースがあります。

線形計画問題においては、制約関数はすべてアフィン関数であり、かつ実行可能解が境界上（\\(g _ {i}(x) = 0\\)）に存在するケースも多いです。このような場合には、スレーター条件の「全ての不等式制約に対して厳密な不等号が成立する」という仮定が満たされない可能性があります。にもかかわらず、線形計画問題では通常、強双対性が成立します。

こうした現象を説明し、より広範な問題に対応できるようにするために、緩和されたスレーター条件を導入します。

緩和された条件では、アフィン関数で表現された不等式制約に対しては不等号（\\(\leq\\)）が成り立つだけで十分であるとし、アフィンではない不等式制約に対してのみ厳密な不等号（\\(<\\)）が成り立つことを要求します。このことにより、線形計画問題を含むより広いクラスの問題に対しても、強双対性の成立を保証することが可能です。

以下に、緩和されたスレーター条件の定義を述べます。

<br>

**Definition (緩和されたスレーター条件)**
> 不等式制約付き最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\} \cup \\{g' _ {i'}\\}\, \\{h _ {j}\\} \right)\\) を考えます。
> さらに \\(\mathcal{P}\\) が凸最適化問題であるとします。
> 
> 以下の条件を満たす \\(x _ {0}\\) が存在するとき、この最適化問題は緩和されたスレーター条件を満たすと定義します。
> - \\(x _ {0}\\) が \\( \text{dom} (\mathcal{P})\\) の内点である
> - \\(g' _ {i'}\, h _ {j}\\) がアフィン関数である
> - \\( g _ i(x _ 0) < 0 \quad (\forall \\, i) \\)
> - \\( g' _ {i'}(x _ 0) \leq 0 \quad (\forall \\, i') \\)
> - \\( h _ j(x _ 0) = 0 \quad (\forall \\, j) \\)
> 

<br>

<!-- 
この文章は、読者に「なぜスレーター条件だけでは不十分なのか」「なぜ定義を拡張する必要があるのか」を納得感を持って伝える構成になっています。補足として、線形計画における双対性の成立が緩和条件で保証される例を示すと、さらに効果的です。
-->

緩和されたスレーター条件は、アフィンな制約に対しては不等号の厳密性を求めないことで、より柔軟な条件となっていました。では実際に、この条件のもとでも強双対性が成立することを示しましょう。

この証明の基本的なアイデアは、緩和されたスレーター条件を満たす最適化問題を、適切な変形によって元のスレーター条件を満たす形に書き換えるというものです。すなわち、非アフィンな不等式制約だけに注目し、アフィンな制約をそのまま残す形で主問題を分離・再構成することで、以前に示したスレーター条件の下での強双対定理に帰着させます。

それでは、具体的に命題の主張と証明を述べます。

<br>

**Propositon（スレーター条件を緩和しても強双対性が成り立つ）**
> 不等式制約付き**凸最適化問題** \\(\mathcal{P} \left( f\, \\{g _ {i}\\} \cup \\{g' _ {i'}\\}\, \\{h _ {j}\\} \right)\\) が緩和されたスレーター条件を満たすならば、強双対性が成り立ちます。
> また、双対問題の最適解も存在します。
> 
> <details><summary>(Proof)</summary><div>
> 
> 以下を満たす \\(\\{1\, \dots\, i' \\}\\) の部分集合 \\(I _ {\max}^{'}\\) が存在することを示せば、\\(\mathcal{P}\\) について強双対定理が成り立つことが示せます。
> - 最適化問題 \\(\mathcal{P} \left( f\, \\{g _ {i}\\} \cup \\{g' _ {i'}\\}\, \\{h _ {j}\\} \right)\\) が
> 最適化問題 \\(\mathcal{P'} \left( f\, \\{g _ {i}\\} \cup \\{g' _ {i'}\\} _ {i' \in I _ {\max}^{'}}\, \\{h _ {j}\\} \cup \\{g' _ {i'}\\} _ {i' \notin I _ {\max}^{'}} \right)\\) と一致する。
> - \\(\mathcal{P'}\\) がスレーター条件を満たす。
> 
> \\(\\{1\, \dots\, i' \\}\\) の任意の部分集合 \\(I _ {0}^{'}\\) に対して、条件（＊）を考える。
>
> 条件（＊）: 以下の条件を満たす \\(\hat{x}\\) が存在する:
> \\[ \\begin{gather*}  g _ {i}(\\hat{x}) \\leq 0\, \\\\   g' _ {i'}(\\hat{x}) < 0 \\\; (i' \\in I _ {0}^{'})\, \\\\   g' _ {i'}(\\hat{x}) = 0 \\\; (i' \\notin I _ {0}^{'})\, \\\\   h _ {j}(\\hat{x}) = 0.  \\end{gather*} \\]
> 
> \\(I _ {1}^{'}\, \\; I _ {2}^{'}\\) が条件（＊）を満たすのならば、\\(I _ {1}^{'} \cup I _ {2}^{'}\\) が条件（＊）を満たすことを示そう。
> これは、\\(I _ {1}^{'}\\) 由来の \\(\hat{x} _ {1}\\) と \\(I _ {2}^{'}\\) 由来の \\(\hat{x} _ {2}\\) がある場合に、
> \\(I _ {1}^{'} \cup I _ {2}^{'}\\) に対して \\(\frac{\hat{x} _ {1} + \hat{x} _ {2}}{2}\\) が条件（＊）を満たすことからわかる。
> 
> このことから、以下の条件を満たす \\(I _ {\max}^{'}\\) が存在する。
> 
> - \\(I _ {\max}^{'}\\) が条件（＊）を満たす。
> - \\(I _ {0}^{'}\\) が条件（＊）を満たすならば、\\(I _ {0}^{'} \subseteq I _ {\max}^{'}\\) を満たす。
> 
> \\(I _ {\max}^{'}\\) の最大性から、最適化問題 \\(\mathcal{P}\\) が \\(\mathcal{P'}\\) と一致することがわかる。
> 
> スレーター条件から以下を満たす \\(\tilde{x}\\) が存在する:
> \\[ \\begin{gather*}  g _ {i}(\\tilde{x}) < 0\, \\\\   g' _ {i'}(\\tilde{x}) \\leq 0 \\\; (\\forall i')\, \\\\   h _ {j}(\\tilde{x}) = 0.  \\end{gather*} \\]
> 
> \\(I _ {\max}^{'}\\) の条件（＊）から以下を満たす \\(\hat{x}\\) が存在する:
> \\[ \\begin{gather*}  g _ {i}(\\hat{x}) \\leq 0\, \\\\   g' _ {i'}(\\hat{x}) < 0 \\\; (i' \\in I _ {\\max}^{'})\, \\\\   g' _ {i'}(\\hat{x}) = 0 \\\; (i' \\notin I _ {\\max}^{'})\, \\\\   h _ {j}(\\hat{x}) = 0.  \\end{gather*} \\]
> 
> \\(\tilde{x}\\) が \\(\text{dom} (f)\\) の内点なので、\\(g _ {i}\\) は \\(\tilde{x}\\) で連続である。
> よって、ある \\(0 < \lambda < 1\\) が存在して、以下の条件を満たす
> \\[ \\begin{gather*}  x _ {0} = (1 - \\lambda) \\tilde{x} + \\lambda \\hat{x}\, \\\\   g _ {i}(\\hat{x}) < 0\, \\\\   g' _ {i'}(\\hat{x}) < 0 \\\; (i' \\in I _ {\\max}^{'})\, \\\\   g' _ {i'}(\\hat{x}) = 0 \\\; (i' \\notin I _ {\\max}^{'})\, \\\\   h _ {j}(\\hat{x}) = 0.  \\end{gather*} \\]
> 
> 以上より、\\(\mathcal{P'}\\) がスレーター条件を満たすことが示せた。
> 
> </div></details>



<br><br>



## 結論
---

本記事では、不等式制約付き最適化問題に対して定義される双対問題の基本的な構造と、その理論的意義について整理してきました。
特に重要なポイントは以下の通りです:

- 双対関数は主問題の目的関数の下界を与え、双対問題はそれを最大化する問題として自然に定義される。
- 弱双対性は常に成り立ち、双対問題が主問題の有用な近似・評価手段となる。
- 一方で、強双対性（双対ギャップがゼロであること）が成り立つためには条件が必要であり、その代表例がスレーター条件である。
- 特に、凸最適化問題ではスレーター条件が満たされれば強双対性が保証されることから、理論的にも計算的にも双対問題を解くことに大きな意味がある。

双対理論は、単なる数学的な枠組みにとどまらず、線形計画法・機械学習・信号処理・経済学的均衡理論など、非常に多くの分野に応用されています。
そのため、今回扱った双対性に関する概念や条件は、最適化に関するあらゆる理論やアルゴリズムの基盤となる考え方です。

最適化問題の解き方をさらに掘り下げていく中で、ここで整理した双対問題の構造や強双対性の成立条件は繰り返し登場する基本事項です。
凸最適化問題の理論的背景をしっかり押さえたうえで、必要なときに手元に置いて参照できるような「チートシート」として、ぜひ活用していただければと思います。



<br><br>



## 参考文献
---

- <a id="kanamaori"></a>金森敬文（2015）『統計的学習理論』共立出版（機械学習プロフェッショナルシリーズ）
- <a id="boyd"></a>Boyd, S., & Vandenberghe, L. (2004). *Convex optimization*. Cambridge University Press.


